<%provide(:title,@category.name)%>
<div class="row pt-2 pb-2">
  <div class="col Item-title">
    <h1><%= @category.name %></h1>
  </div>
</div>
<div class="row">   
    <%= form_with(url: category_path(@category), method: :get, local: true, class: 'my-3') do %>
      <div class="col d-flex flex-wrap">
        <% Tag.all.each do |tag| %>
          <div class="form-check mb-2 me-3">
            <%= check_box_tag 'tags[]', tag.id, params[:tags]&.include?(tag.id.to_s), class: 'form-check-input' %>
            <%= label_tag "tags_#{tag.id}", tag.name, class: 'form-check-label' %>
          </div>
        <% end %>
            <%= submit_tag 'Filter', class: 'btn btn-primary' %>
      </div>
    <% end %>
    <div class="col pt-2 dropdown  d-flex justify-content-end">
      <a class="btn btn-outline-primary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
        Sort
      </a>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenuLink">
        <li><%= link_to 'Low-price', category_path(price_asc: "true"), class:"dropdown-item" %></li>
        <li><%= link_to 'High-price', category_path(price_desc: "true"), class:"dropdown-item" %></li>
        <li><%= link_to 'latest', category_path(new_item: "true"), class:"dropdown-item" %></li>
      </ul>
    </div>
  </div>
<div class="row row-cols-1 row-cols-md-3 g-4 pt-3"> 
  <% @items.each do|item| %>
    <div class="col-4 col-md-6 col-lg-4 px-0">
      <div class="card h-100"> 
        <%= image_tag item.images.first.variant(resize_to_fill: [400, 400]).processed,class:"card-img-top p-0" %>
        <div class="card-body">
          <div class="product-price-index pb-4 text-success"><span><%=item.price%>$</span></div>  
          <%= link_to("show", item_path(item), {class: "btn btn-primary stretched-link"}) %>
        </div>
      </div>
    </div>
  <% end %>
</div> 
<%= paginate @items, theme: 'bootstrap-5' %>